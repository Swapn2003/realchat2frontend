{"ast":null,"code":"var _jsxFileName = \"D:\\\\IIT Guwahati\\\\cpp\\\\New folder\\\\helloworld\\\\WEB_D\\\\Real_time_chat\\\\frontend\\\\src\\\\context\\\\SocketProvider.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/React.createContext();\nexport function useSocket() {\n  _s();\n  return useContext(SocketContext);\n}\n_s(useSocket, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport function SocketProvider(_ref) {\n  _s2();\n  let {\n    id,\n    children\n  } = _ref;\n  const [socket, setSocket] = useState();\n\n  // useEffect(() => {\n  //   const newSocket = io(\n  //     'http://localhost:5000',\n  //     { query: { id } }\n  //   )\n  //   setSocket(newSocket)\n\n  //   return () => newSocket.close()\n  // }, [id])\n\n  useEffect(() => {\n    fetch(`http://localhost:5000/socket.io/?id=${id}`, {\n      method: 'GET',\n      mode: 'cors',\n      credentials: 'same-origin'\n    }).then(response => response.json()).then(data => {\n      const newSocket = io.connect('http://localhost:5000', {\n        query: {\n          id\n        },\n        transports: ['websocket'],\n        reconnectionAttempts: 3,\n        timeout: 10000,\n        auth: {\n          token: data.token\n        }\n      });\n      setSocket(newSocket);\n    }).catch(error => {\n      console.error('Error connecting to socket:', error);\n    });\n    return () => {\n      if (socket) {\n        socket.disconnect();\n      }\n    };\n  }, [id, socket]);\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: socket,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s2(SocketProvider, \"hiNpVvqoDzQD/SDhIdq26R3jJHg=\");\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["React","useContext","useEffect","useState","io","jsxDEV","_jsxDEV","SocketContext","createContext","useSocket","_s","SocketProvider","_ref","_s2","id","children","socket","setSocket","fetch","method","mode","credentials","then","response","json","data","newSocket","connect","query","transports","reconnectionAttempts","timeout","auth","token","catch","error","console","disconnect","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/IIT Guwahati/cpp/New folder/helloworld/WEB_D/Real_time_chat/frontend/src/context/SocketProvider.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport io from 'socket.io-client'\r\n\r\nconst SocketContext = React.createContext()\r\n\r\nexport function useSocket() {\r\n  return useContext(SocketContext)\r\n}\r\n\r\nexport function SocketProvider({ id, children }) {\r\n  const [socket, setSocket] = useState()\r\n\r\n  // useEffect(() => {\r\n  //   const newSocket = io(\r\n  //     'http://localhost:5000',\r\n  //     { query: { id } }\r\n  //   )\r\n  //   setSocket(newSocket)\r\n\r\n  //   return () => newSocket.close()\r\n  // }, [id])\r\n\r\n  useEffect(() => {\r\n    fetch(`http://localhost:5000/socket.io/?id=${id}`, {\r\n      method: 'GET',\r\n      mode: 'cors',\r\n      credentials: 'same-origin'\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n      const newSocket = io.connect('http://localhost:5000', {\r\n        query: { id },\r\n        transports: ['websocket'],\r\n        reconnectionAttempts: 3,\r\n        timeout: 10000,\r\n        auth: { token: data.token }\r\n      });\r\n      setSocket(newSocket);\r\n    })\r\n    .catch(error => {\r\n      console.error('Error connecting to socket:', error);\r\n    });\r\n  \r\n    return () => {\r\n      if (socket) {\r\n        socket.disconnect();\r\n      }\r\n    };\r\n  }, [id,socket]);\r\n  \r\n\r\n  return (\r\n    <SocketContext.Provider value={socket}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  )\r\n}"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC9D,OAAOC,EAAE,MAAM,kBAAkB;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAEjC,MAAMC,aAAa,gBAAGP,KAAK,CAACQ,aAAa,CAAC,CAAC;AAE3C,OAAO,SAASC,SAASA,CAAA,EAAG;EAAAC,EAAA;EAC1B,OAAOT,UAAU,CAACM,aAAa,CAAC;AAClC;AAACG,EAAA,CAFeD,SAAS;AAIzB,OAAO,SAASE,cAAcA,CAAAC,IAAA,EAAmB;EAAAC,GAAA;EAAA,IAAlB;IAAEC,EAAE;IAAEC;EAAS,CAAC,GAAAH,IAAA;EAC7C,MAAM,CAACI,MAAM,EAAEC,SAAS,CAAC,GAAGd,QAAQ,CAAC,CAAC;;EAEtC;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;;EAEAD,SAAS,CAAC,MAAM;IACdgB,KAAK,CAAE,uCAAsCJ,EAAG,EAAC,EAAE;MACjDK,MAAM,EAAE,KAAK;MACbC,IAAI,EAAE,MAAM;MACZC,WAAW,EAAE;IACf,CAAC,CAAC,CACDC,IAAI,CAACC,QAAQ,IAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,IAAI;MACZ,MAAMC,SAAS,GAAGtB,EAAE,CAACuB,OAAO,CAAC,uBAAuB,EAAE;QACpDC,KAAK,EAAE;UAAEd;QAAG,CAAC;QACbe,UAAU,EAAE,CAAC,WAAW,CAAC;QACzBC,oBAAoB,EAAE,CAAC;QACvBC,OAAO,EAAE,KAAK;QACdC,IAAI,EAAE;UAAEC,KAAK,EAAER,IAAI,CAACQ;QAAM;MAC5B,CAAC,CAAC;MACFhB,SAAS,CAACS,SAAS,CAAC;IACtB,CAAC,CAAC,CACDQ,KAAK,CAACC,KAAK,IAAI;MACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACrD,CAAC,CAAC;IAEF,OAAO,MAAM;MACX,IAAInB,MAAM,EAAE;QACVA,MAAM,CAACqB,UAAU,CAAC,CAAC;MACrB;IACF,CAAC;EACH,CAAC,EAAE,CAACvB,EAAE,EAACE,MAAM,CAAC,CAAC;EAGf,oBACEV,OAAA,CAACC,aAAa,CAAC+B,QAAQ;IAACC,KAAK,EAAEvB,MAAO;IAAAD,QAAA,EACnCA;EAAQ;IAAAyB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACa,CAAC;AAE7B;AAAC9B,GAAA,CA/CeF,cAAc;AAAAiC,EAAA,GAAdjC,cAAc;AAAA,IAAAiC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}